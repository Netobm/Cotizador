<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Autos Seminuevos Fundadores</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <style>
    * {
      font-family: 'Poppins', sans-serif;
      box-sizing: border-box;
    }
    body {
      margin: 0;
      background-color: #f4f4f4;
      color: #333;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 10px;
    }
    .form-container, .result-container {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      max-width: 800px;
      margin: 20px auto;
    }
    label {
      display: block;
      margin-top: 15px;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    button {
      margin: 15px 10px 0 0;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      background-color: #2c3e50;
      color: white;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    button:hover {
      background-color: #1a252f;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: center;
    }
    th {
      background-color: #ecf0f1;
    }
    .footer-note {
      text-align: center;
      font-size: 0.9em;
      margin-top: 20px;
      font-style: italic;
    }
    #descargarBtn {
      display: inline-block;
    }
  </style>
</head>
<body>
  <h1>Autos Seminuevos Fundadores</h1>
  <div class="form-container">
    <label>Marca:<input type="text" id="marca" required></label>
    <label>Modelo:<input type="text" id="modelo" required></label>
    <label>Año:<input type="number" id="anio" required></label>
    <label>Precio:<input type="number" id="precio" required></label>
    <label>Enganche:<input type="number" id="enganche" required></label>
    <label>Tasa de interés mensual (%):<input type="number" id="interes" value="0" step="0.01"></label>
    <button onclick="cotizar()">Generar Cotización</button>
    <button onclick="limpiarFormulario()">Limpiar Formulario</button>
  </div>

  <div class="result-container" id="resultado">
    <div id="resultadoContenido" style="display: none;">
      <h2>Resultados de Cotización</h2>
      <p><strong>Marca:</strong> <span id="resMarca"></span></p>
      <p><strong>Modelo:</strong> <span id="resModelo"></span></p>
      <p><strong>Año:</strong> <span id="resAnio"></span></p>
      <p><strong>Precio:</strong> $<span id="resPrecio"></span></p>
      <p><strong>Enganche:</strong> $<span id="resEnganche"></span></p>
      <table>
        <thead>
          <tr><th>Plazo</th><th>Mensualidad</th></tr>
        </thead>
        <tbody id="tablaMensualidades"></tbody>
      </table>
      <div class="footer-note">*Precio sujeto a aprobación</div>
    </div>
  </div>

  <div style="text-align: center;">
    <button id="descargarBtn" onclick="descargarImagen()">Descargar Imagen</button>
    <button onclick="enviarWhatsApp()">Enviar por WhatsApp</button>
  </div>

  <script>
    function cotizar() {
      const marca = document.getElementById('marca').value;
      const modelo = document.getElementById('modelo').value;
      const anio = document.getElementById('anio').value;
      const precio = parseFloat(document.getElementById('precio').value);
      const enganche = parseFloat(document.getElementById('enganche').value);
      const interes = parseFloat(document.getElementById('interes').value || 0) / 100;

      if (!marca || !modelo || !anio || isNaN(precio) || isNaN(enganche)) {
        alert("Morro puñetas");
        return;
      }
      if (enganche >= precio) {
        alert("Morro puñetas");
        return;
      }

      const plazoMeses = [12, 24, 36, 48, 60];
      const montoFinanciar = precio - enganche;
      const tbody = document.getElementById("tablaMensualidades");
      tbody.innerHTML = "";
      plazoMeses.forEach(plazo => {
        const mensualidad = montoFinanciar * Math.pow(1 + interes, plazo) * interes / (Math.pow(1 + interes, plazo) - 1);
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${plazo} meses</td><td>$${mensualidad.toFixed(2)}</td>`;
        tbody.appendChild(tr);
      });

      document.getElementById("resMarca").textContent = marca;
      document.getElementById("resModelo").textContent = modelo;
      document.getElementById("resAnio").textContent = anio;
      document.getElementById("resPrecio").textContent = precio.toLocaleString();
      document.getElementById("resEnganche").textContent = enganche.toLocaleString();
      document.getElementById("resultadoContenido").style.display = 'block';
    }

    function limpiarFormulario() {
      document.getElementById('marca').value = "";
      document.getElementById('modelo').value = "";
      document.getElementById('anio').value = "";
      document.getElementById('precio').value = "";
      document.getElementById('enganche').value = "";
      document.getElementById('interes').value = "0";
      document.getElementById("resultadoContenido").style.display = 'none';
    }

    function descargarImagen() {
      const resultado = document.getElementById("resultadoContenido");
      html2canvas(resultado).then(canvas => {
        canvas.toBlob(blob => {
          const url = URL.createObjectURL(blob);
          const link = document.createElement("a");
          link.href = url;
          link.download = "cotizacion.png";
          link.click();
        });
        canvas.toBlob(blob => navigator.clipboard.write([new ClipboardItem({'image/png': blob})]));
      });
    }

    function enviarWhatsApp() {
      const marca = document.getElementById('marca').value;
      const modelo = document.getElementById('modelo').value;
      const anio = document.getElementById('anio').value;
      const precio = document.getElementById('precio').value;
      const enganche = document.getElementById('enganche').value;
      const link = `https://wa.me/?text=Cotización%20de%20auto:%0A${marca}%20${modelo}%20${anio}%0APrecio:%20$${precio}%0AEnganche:%20$${enganche}`;
      window.open(link, '_blank');
    }
  </script>
</body>
</html>
